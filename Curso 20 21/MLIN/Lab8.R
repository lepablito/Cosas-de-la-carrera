library(eftar);library(car);library(MASS)
attach(trees)
y<-Volume
x1<-Height
x2<-Girth
modelo1<-lm(y~x1+x2);modelo1
par(mfrow=c(2,2))
plot(modelo1)

4/df.residual(modelo1)#Distancia de Cook
abline(v=4/df.residual(modelo1), lty=3)
DC1 <- cooks.distance(modelo1); DC1
DC1[DC1>4/df.residual(modelo1)] #Quedan 4 puntos de influencia

dfbetas(modelo1)
influence.measures(modelo1)

qt(0.975,df.residual(modelo1))
qt(1-0.05/(2*nrow(trees)),df.residual(modelo1))

rstandard(modelo1)
rstudent(modelo1)
plot(fitted(modelo1),rstandard(modelo1))
bc1<-boxcox(modelo1);bc1
bc1$x[which.max(bc1$y)]

boxTidwell(y~x1+x2)
boxcox(modelo1, plot=F)#con el 0.3 que es el valor 24 que es el valor maximo de y pues podemos hacer la transformacion boxcox siendo 0.3 el lambda
y1<-(y^0.3-1)/0.3
plot(lm(y1~x1+x2)) #Parece que se ha solucionado el problema de linealidad
boxTidwell(y1~x1+x2)

avPlots(modelo1)
crPlots(modelo1)



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































